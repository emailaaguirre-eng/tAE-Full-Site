/*! For license information please see artkey-viewer.js.LICENSE.txt */
(()=>{"use strict";var e={20:(e,t,r)=>{var n=r(594),o=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(e,t,r){var n,s={},u=null,c=null;for(n in void 0!==r&&(u=""+r),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,n)&&!i.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:o,type:e,key:u,ref:c,props:s,_owner:l.current}}t.jsx=s,t.jsxs=s},206:e=>{e.exports=ReactDOM},338:(e,t,r)=>{var n=r(206);t.H=n.createRoot,n.hydrateRoot},594:e=>{e.exports=React},848:(e,t,r)=>{e.exports=r(20)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}var n,o,a=r(594),l=r(338),i=r(848);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t,r){return(t=function(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var s=n&&n.prototype instanceof i?n:i,u=Object.create(s.prototype);return p(u,"_invoke",function(r,n,o){var a,i,s,u=0,c=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return a=t,i=0,s=e,f.n=r,l}};function p(r,n){for(i=r,s=n,t=0;!d&&u&&!o&&t<c.length;t++){var o,a=c[t],p=f.p,v=a[2];r>3?(o=v===n)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=r<2&&p<a[1])?(i=0,f.v=n,f.n=a[1]):p<v&&(o=r<3||a[0]>n||n>v)&&(a[4]=r,a[5]=n,f.n=v,i=0))}if(o||r>1)return l;throw d=!0,n}return function(o,c,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&p(c,v),i=c,s=v;(t=i<2?e:s)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(u=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?s:r.call(n,f))!==l)break}catch(t){a=e,i=1,s=t}finally{u=1}}return{value:t,done:d}}}(r,o,a),!0),u}var l={};function i(){}function s(){}function u(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(p(t={},n,function(){return this}),t),d=u.prototype=i.prototype=Object.create(c);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,p(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=u,p(d,"constructor",u),p(u,"constructor",s),s.displayName="GeneratorFunction",p(u,o,"GeneratorFunction"),p(d),p(d,o,"Generator"),p(d,n,function(){return this}),p(d,"toString",function(){return"[object Generator]"}),(f=function(){return{w:a,m:v}})()}function p(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}p=function(e,t,r,n){function a(t,r){p(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},p(e,t,r,n)}function v(e,t,r,n,o,a,l){try{var i=e[a](l),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function y(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function l(e){v(a,n,o,l,i,"next",e)}function i(e){v(a,n,o,l,i,"throw",e)}l(void 0)})}}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,l,i=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var h=(null===(n=window.ArtKeyViewer)||void 0===n?void 0:n.rest)||{token:"/wp-json/artkey/v1/token",guestbookList:"/wp-json/artkey/v1/guestbook",guestbookAdd:"/wp-json/artkey/v1/guestbook"},x=(null===(o=window.ArtKeyViewer)||void 0===o?void 0:o.nonce)||"",g="#353535";function j(e){var t,r,n,o,l,s=e.token,u=m((0,a.useState)(null),2),d=u[0],p=u[1],v=m((0,a.useState)(!0),2),b=v[0],j=v[1],S=m((0,a.useState)(null),2),_=S[0],P=S[1],E=m((0,a.useState)(null),2),C=E[0],A=E[1],F=m((0,a.useState)([]),2),T=F[0],G=F[1],I=m((0,a.useState)({name:"",message:""}),2),L=I[0],D=I[1],R=m((0,a.useState)(!1),2),V=R[0],M=R[1],K=m((0,a.useState)(null),2),H=K[0],U=K[1];(0,a.useEffect)(function(){$()},[s]);var $=function(){var e=y(f().m(function e(){var t,r,n;return f().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,j(!0),e.n=1,fetch("".concat(h.token,"/").concat(s));case 1:if((t=e.v).ok){e.n=2;break}throw new Error("Failed to load ArtKey");case 2:return e.n=3,t.json();case 3:return r=e.v,p((null==r?void 0:r.data)||r),e.n=4,B(s);case 4:e.n=6;break;case 5:e.p=5,n=e.v,P(n.message||"Failed to load ArtKey");case 6:return e.p=6,j(!1),e.f(6);case 7:return e.a(2)}},e,null,[[0,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=y(f().m(function e(t){var r,n;return f().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("".concat(h.guestbookList,"/").concat(t));case 1:if((r=e.v).ok){e.n=2;break}return e.a(2);case 2:return e.n=3,r.json();case 3:n=e.v,G(n.entries||[]),e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[0,4]])}));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=y(f().m(function e(){var t,r,n;return f().w(function(e){for(;;)switch(e.p=e.n){case 0:if(L.message){e.n=1;break}return U("Message required"),e.a(2);case 1:return M(!0),U(null),e.p=2,e.n=3,fetch(h.guestbookAdd,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":x},body:JSON.stringify({token:s,name:L.name,message:L.message})});case 3:if((t=e.v).ok){e.n=5;break}return e.n=4,t.json();case 4:throw r=e.v,new Error(r.message||"Failed to post");case 5:return D({name:"",message:""}),e.n=6,B(s);case 6:e.n=8;break;case 7:e.p=7,n=e.v,U(n.message);case 8:return e.p=8,M(!1),e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(){return e.apply(this,arguments)}}();if(b)return(0,i.jsx)(w,{children:(0,i.jsx)("div",{className:"text-center py-12",children:"Loading..."})});if(_||!d)return(0,i.jsx)(w,{children:(0,i.jsx)("div",{className:"text-center text-red-600 py-12",children:_||"Not found"})});var Y,q=d.theme||{},z=function(e){var t,r,n,o,a,l,i,s=[];return(null!==(t=e.uploadedImages)&&void 0!==t&&t.length||null!==(r=e.features)&&void 0!==r&&r.enable_gallery)&&s.push({id:"gallery",label:"ðŸ–¼ï¸ Gallery"}),(null!==(n=e.uploadedVideos)&&void 0!==n&&n.length||null!==(o=e.features)&&void 0!==o&&o.enable_video)&&s.push({id:"videos",label:"ðŸŽ¥ Videos"}),null!==(a=e.features)&&void 0!==a&&a.show_guestbook&&s.push({id:"guestbook",label:"ðŸ“ Guestbook"}),(null===(l=e.spotify)||void 0===l||null===(l=l.url)||void 0===l?void 0:l.length)>10&&s.push({id:"playlist",label:"ðŸŽµ Playlist"}),null!==(i=e.features)&&void 0!==i&&i.enable_featured_video&&s.push({id:"featured",label:"ðŸŽ¬ Featured Video"}),(e.links||[]).forEach(function(e,t){s.push({id:"link-".concat(t),label:e.label||"Link ".concat(t+1),href:e.url,external:!0})}),s}(d);return(0,i.jsx)(w,{children:(0,i.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,i.jsxs)("header",{className:"card p-6",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold font-playfair mb-2",style:{color:q.title_color||g},children:d.title||"Your ArtKey"}),(0,i.jsx)("div",{className:"flex gap-3 flex-wrap mt-4",children:z.map(function(e){return(0,i.jsx)("button",{onClick:function(){return A(e.id)},className:"px-4 py-2 rounded-full text-sm font-semibold transition-all shadow-sm",style:{background:q.button_color||g,color:O(q.button_color||g)},children:e.label},e.id)})})]}),"gallery"===C&&(0,i.jsx)(k,{title:"Image Gallery",onClose:function(){return A(null)},children:null!==(t=d.uploadedImages)&&void 0!==t&&t.length?(0,i.jsx)("div",{className:"grid grid-cols-2 gap-3",children:d.uploadedImages.map(function(e,t){return(0,i.jsx)("img",{src:e,alt:"",className:"w-full h-40 object-cover rounded-lg border border-[#e2e2e0]"},t)})}):(0,i.jsx)("p",{children:"No images yet."})}),"videos"===C&&(0,i.jsx)(k,{title:"Video Gallery",onClose:function(){return A(null)},children:null!==(r=d.uploadedVideos)&&void 0!==r&&r.length?(0,i.jsx)("div",{className:"space-y-3",children:d.uploadedVideos.map(function(e,t){return(0,i.jsx)("video",{src:e,controls:!0,className:"w-full rounded-lg border border-[#e2e2e0]"},t)})}):(0,i.jsx)("p",{children:"No videos yet."})}),"playlist"===C&&(0,i.jsx)(k,{title:"Playlist",onClose:function(){return A(null)},children:(null===(n=d.spotify)||void 0===n||null===(n=n.url)||void 0===n?void 0:n.length)>10?(0,i.jsx)("iframe",{src:(Y=d.spotify.url,Y.replace("open.spotify.com","open.spotify.com/embed")),width:"100%",height:"380",allow:"encrypted-media",className:"rounded-lg border border-[#e2e2e0]"}):(0,i.jsx)("p",{children:"No playlist provided."})}),"featured"===C&&(0,i.jsx)(k,{title:"Featured Video",onClose:function(){return A(null)},children:(0,i.jsx)("video",{controls:!0,className:"w-full rounded-lg border border-[#e2e2e0]",children:(0,i.jsx)("source",{src:(null===(o=d.featured_video)||void 0===o?void 0:o.src)||(null===(l=d.featured_video)||void 0===l?void 0:l.url)||""})})}),"guestbook"===C&&(0,i.jsx)(k,{title:"Guestbook",onClose:function(){return A(null)},children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm font-semibold",children:"Name (optional)"}),(0,i.jsx)("input",{type:"text",value:L.name,onChange:function(e){return D(function(t){return c(c({},t),{},{name:e.target.value})})},className:"w-full px-3 py-2 rounded border border-[#d8d8d6]"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm font-semibold",children:"Message"}),(0,i.jsx)("textarea",{value:L.message,onChange:function(e){return D(function(t){return c(c({},t),{},{message:e.target.value})})},className:"w-full px-3 py-2 rounded border border-[#d8d8d6]",rows:3})]}),H&&(0,i.jsx)("p",{className:"text-sm text-red-600",children:H}),(0,i.jsx)("button",{onClick:W,disabled:V,className:"w-full py-2 rounded font-semibold",style:{background:g,color:"#fff"},children:V?"Sending...":"Sign Guestbook"}),(0,i.jsxs)("div",{className:"pt-4 border-t border-[#e2e2e0] space-y-3",children:[0===T.length&&(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"No entries yet."}),T.map(function(e){return(0,i.jsxs)("div",{className:"p-3 rounded border border-[#e2e2e0]",style:{background:"#FFFFFF"},children:[(0,i.jsx)("div",{className:"text-sm font-semibold",style:{color:g},children:e.name||"Guest"}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:N(e.date)}),(0,i.jsx)("div",{className:"mt-1 text-sm",dangerouslySetInnerHTML:{__html:e.message}})]},e.id)})]})]})})]})})}function w(e){var t=e.children;return(0,i.jsx)("div",{style:{background:"#ECECE9",minHeight:"100vh",padding:"24px"},children:t})}function k(e){var t=e.title,r=e.children,n=e.onClose;return(0,i.jsx)("div",{className:"fixed inset-0 modal-backdrop flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"card w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6 relative",children:[(0,i.jsx)("button",{onClick:n,className:"absolute top-3 right-3 text-lg text-gray-500 hover:text-gray-700",children:"Ã—"}),(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",style:{color:g},children:t}),r]})})}function O(e){if(!e)return"#fff";var t=e.toLowerCase();return"#ffffff"===t||"#fefefe"===t||"#fef3c7"===t||"#fde047"===t||"#fffff0"===t?"#000":"#fff"}function N(e){if(!e)return"";try{return new Date(e).toLocaleString()}catch(t){return e}}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("artkey-viewer-root");if(e){var t=e.getAttribute("data-token")||"";(0,l.H)(e).render((0,i.jsx)(j,{token:t}))}})})();